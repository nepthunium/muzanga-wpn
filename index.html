<html>
<head>
<meta http-equiv='refresh' content='10'>
<style>
    body {
    font-family: verdana, helvetica, arial, sans-serif;
    font-size: 10.5px;
    color: #333;
    background-color: #ccc;
    }

    #titles {
    font-family: verdana, helvetica, arial, sans-serif;
    font-size: 9px;
    color: #999;
    text-align: center;
    }

    #ts {
    font-family: verdana, helvetica, arial, sans-serif;
    font-size: 9px;
    color: #999;
    text-align: center;
    }

    #current {
    font-family: verdana, helvetica, arial, sans-serif;
    font-size: 10.5px;
    text-align: center;
    }

    #history {
    font-family: verdana, helvetica, arial, sans-serif;
    font-size: 10.5px;
    text-align: center;
    }
</style>
</head>
<body>
<table width="300" border="0" align="center" cellpadding="5" cellspacing="4" bgcolor="#FFFFFF"></table>
<h3 id="titles">Now on Crystallite</h3>
<p id="current">Loading...</p>

<h3 id="titles">The last ten songs on Crystallite</h3>
<div id="history"></div>

<p id="ts"></p>

<script>
async function updateSongs() {
  try {
    const response = await fetch('songs.json?' + new Date().getTime());
    const data = await response.json(); // safer than eval

    document.getElementById('current').textContent = data.current;

    const historyEl = document.getElementById('history');
    historyEl.innerHTML = '';
    data.history.forEach(song => {
      const p = document.createElement('p');
      p.textContent = song;
      historyEl.appendChild(p);
    });

    document.getElementById('ts').textContent = `Updated: ${data.timestamp}`;
  } catch (err) {
    console.error('Failed to fetch songs:', err);
  }
}

updateSongs();
setInterval(updateSongs, 20000);
</script>
</table>
</body>
</html>
