<html>
<head>
<meta http-equiv='refresh' content='10'>
</head>
<body>
<h3>Now on Crystallite</h3>
<p id="current">Loading...</p>

<h3>The last ten songs on Crystallite</h3>
<div id="history"></div>

<p id="ts"></p>

<script>
async function updateSongs() {
  try {
    const response = await fetch('songs.json?' + new Date().getTime());
    const data = await response.json(); // safer than eval

    document.getElementById('current').textContent = data.current;

    const historyEl = document.getElementById('history');
    historyEl.innerHTML = '';
    data.history.forEach(song => {
      const p = document.createElement('p');
      p.textContent = song;
      historyEl.appendChild(p);
    });

    document.getElementById('ts').textContent = `Updated: ${data.timestamp}`;
  } catch (err) {
    console.error('Failed to fetch songs:', err);
  }
}

updateSongs();
setInterval(updateSongs, 10000);
</script>
</body>
</html>
