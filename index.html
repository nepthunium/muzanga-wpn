<html>
<head>
<meta http-equiv='refresh' content='30'>
<style>
    body {
        font-family: verdana, helvetica, arial, sans-serif;
        font-size: 10.5px;
        color: #333;
        background-color: #000000;
    }

    #titles {
        font-family: verdana, helvetica, arial, sans-serif;
        font-size: 10.5px;
    }

    #ts {
    font-family: verdana, helvetica, arial, sans-serif;
    font-size: 9px;
    color: #999;
    text-align: center;
    }

    #current {
    font-family: verdana, helvetica, arial, sans-serif;
    font-size: 10.5px;
    }

    #history {
    font-family: verdana, helvetica, arial, sans-serif;
    font-size: 10.5px;
    }
</style>
</head>
<body>
<table width="300" border="0" align="center" cellpadding="5" cellspacing="4" bgcolor="#FFFFFF">
<tr>
<td>
<b id="titles">Now on Crystallite</b>
<div id="current">Loading...</div>
<br>
<b id="titles">The last ten songs on Crystallite</b>
<div id="history"></div>
<div id="ts"></div>
</td>
</tr>
</table>
<script>
async function updateSongs() {
  try {
    const response = await fetch('songs.json?' + new Date().getTime());
    const data = await response.json(); // safer than eval

    document.getElementById('current').textContent = data.current;

    const historyEl = document.getElementById('history');
    historyEl.innerHTML = '';
    data.history.forEach(song => {
      const p = document.createElement('p');
      p.textContent = song;
      historyEl.appendChild(p);
    });

    document.getElementById('ts').textContent = `Updated: ${data.timestamp}`;
  } catch (err) {
    console.error('Failed to fetch songs:', err);
  }
}

updateSongs();
setInterval(updateSongs, 20000);
</script>
</body>
</html>
